SELECT 'AWR' DATA_TYPE ,
       A.SNAP_ID,
       A.INSTANCE_NUMBER,
       (SELECT UPPER( INSTANCE_NAME )
        FROM   DBA_HIST_DATABASE_INSTANCE I
        WHERE  I.INSTANCE_NUMBER=A.INSTANCE_NUMBER
        AND    ROWNUM =1
       ) INSTANCE_NAME ,
       A.BEGIN_INTERVAL_TIME BEGIN_TIME ,
       A.END_INTERVAL_TIME END_TIME ,
       PARSING_SCHEMA_NAME,
       SQL_ID ,
       PLAN_HASH_VALUE,
       SHARABLE_MEM,
       MODULE ,
       ELAPSED_TIME_DELTA ,
       CPU_TIME_DELTA ,
       IOWAIT_DELTA,
       EXECUTIONS_DELTA ,
       DISK_READS_DELTA ,
       BUFFER_GETS_DELTA ,
       ROWS_PROCESSED_DELTA
FROM   DBA_HIST_SNAPSHOT A ,
       DBA_HIST_SQLSTAT B
WHERE  A.SNAP_ID=B.SNAP_ID
AND    A.DBID=B.DBID
AND    A.INSTANCE_NUMBER=B.INSTANCE_NUMBER
AND TO_CHAR(A.END_INTERVAL_TIME, 'YYYY-MM-DD') >= '#(StartDate)'
AND TO_CHAR(A.END_INTERVAL_TIME, 'YYYY-MM-DD') < '#(EndDate)'
