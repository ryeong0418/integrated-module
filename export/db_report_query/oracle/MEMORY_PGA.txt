WITH BASE AS (SELECT INST_ID, PGA_TARGET_FOR_ESTIMATE, PGA_TARGET_FACTOR, ESTD_PGA_CACHE_HIT_PERCENTAGE, ESTD_OVERALLOC_COUNT
				FROM GV$PGA_TARGET_ADVICE
			   WHERE PGA_TARGET_FACTOR = 1)
SELECT A.INST_ID,
	   ROUND(A.PGA_TARGET_FOR_ESTIMATE/1024/1024/1024,1) || DECODE(A.PGA_TARGET_FACTOR,1,'GB(CURRENT)','GB') PGA_SIZE,
	   A.ESTD_PGA_CACHE_HIT_PERCENTAGE - B.ESTD_PGA_CACHE_HIT_PERCENTAGE || '%'  AS PGA_CACHE_HIT_RATIO,
	   ROUND((B.ESTD_OVERALLOC_COUNT - A.ESTD_OVERALLOC_COUNT)*100/B.ESTD_OVERALLOC_COUNT,2) || '%' AS OVERALLOC_RATIO
  FROM GV$PGA_TARGET_ADVICE A, BASE B
 WHERE A.INST_ID = B.INST_ID
   AND A.PGA_TARGET_FACTOR >= 1
ORDER BY A.INST_ID, A.PGA_TARGET_FOR_ESTIMATE