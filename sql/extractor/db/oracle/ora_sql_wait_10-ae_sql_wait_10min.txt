SELECT A.PARTITION_KEY ,
        A.DB_ID ,
        A.TIME ,
        A.SQL_UID,
        A.SQL_ID ,
        A.SQL_PLAN_HASH ,
        (SELECT VALUE FROM APM_STRING_DATA WHERE ID = A.USER_NAME_ID AND ID_TYPE='USER_NAME') AS SCHEMA,
        (SELECT VALUE FROM APM_STRING_DATA WHERE ID = A.PROGRAM_ID AND ID_TYPE='PROGRAM') AS PROGRAM,
        A.MODULE ,
        A.ACTION ,
        (SELECT VALUE FROM APM_STRING_DATA WHERE ID = A.MACHINE_ID AND ID_TYPE='MACHINE') AS MACHINE,
        (SELECT VALUE FROM APM_STRING_DATA WHERE ID = A.OS_USER_ID AND ID_TYPE='OS_USER') AS OS_USER,
        A.WAIT_TIME ,
        A.EVENT_VERSION,
        B.EVENT_NAME,
        B.WAIT_CLASS
FROM #(instance_name).ORA_SQL_WAIT_10MIN A ,
    ORA_EVENT_NAME B
WHERE PARTITION_KEY = #(partition_key)
AND A.DB_ID=B.DB_ID
AND A.EVENT_ID=B.EVENT_ID
AND A.EVENT_VERSION=B.EVENT_VERSION
