WITH OBJ AS (SELECT OWNER, TABLE_NAME as OBJ_NAME, PARTITION_NAME, PARTITION_POSITION, SUBPARTITION_NAME, SUBPARTITION_POSITION, OBJECT_TYPE, SAMPLE_SIZE, LAST_ANALYZED
               FROM DBA_TAB_STATISTICS
              WHERE OWNER NOT IN ('SYS','SYSTEM','GSMADMIN_INTERNAL','DBSNMP','WMSYS','MAXGAUGE','OUTLN','DBSFWUSER','AUDSYS','APPQOSSYS','XDB','OJVMSYS','CTXSYS','ORDSYS','ORDDATA','MDSYS','OLAPSYS','LBACSYS','DVSYS','ORACLE_OCM')
             UNION ALL
             SELECT OWNER, INDEX_NAME as OBJ_NAME, PARTITION_NAME, PARTITION_POSITION, SUBPARTITION_NAME, SUBPARTITION_POSITION, OBJECT_TYPE, SAMPLE_SIZE, LAST_ANALYZED
               FROM DBA_IND_STATISTICS
              WHERE OWNER NOT IN ('SYS','SYSTEM','GSMADMIN_INTERNAL','DBSNMP','WMSYS','MAXGAUGE','OUTLN','DBSFWUSER','AUDSYS','APPQOSSYS','XDB','OJVMSYS','CTXSYS','ORDSYS','ORDDATA','MDSYS','OLAPSYS','LBACSYS','DVSYS','ORACLE_OCM'))
select OWNER, ROUND(AVG(SYSDATE-LAST_ANALYZED)) avg_day
from OBJ
group by OWNER