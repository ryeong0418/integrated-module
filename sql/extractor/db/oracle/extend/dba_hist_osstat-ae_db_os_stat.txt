SELECT 'AWR' DATA_TYPE ,
        A.SNAP_ID,
        A.INSTANCE_NUMBER,
       (SELECT UPPER( INSTANCE_NAME )
        FROM   DBA_HIST_DATABASE_INSTANCE I
        WHERE  I.INSTANCE_NUMBER=A.INSTANCE_NUMBER
        AND    ROWNUM =1
        ) INSTANCE_NAME ,
       A.BEGIN_INTERVAL_TIME BEGIN_TIME ,
       A.END_INTERVAL_TIME END_TIME,
       B.STAT_NAME OS_STAT_NAME ,
       B.VALUE
 FROM  DBA_HIST_SNAPSHOT A ,
       DBA_HIST_OSSTAT B
WHERE  A.SNAP_ID=B.SNAP_ID
  AND  A.DBID=B.DBID
  AND  A.INSTANCE_NUMBER=B.INSTANCE_NUMBER
  AND  TO_CHAR(A.END_INTERVAL_TIME, 'YYYY-MM-DD') >= '#(StartDate)'
  AND  TO_CHAR(A.END_INTERVAL_TIME, 'YYYY-MM-DD') < '#(EndDate)'
